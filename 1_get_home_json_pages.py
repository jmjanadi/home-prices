#!venv/bin/python3
''' Data retrieved from Zillow on 27 July 2023 '''

import requests
import pickle

wc_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22pagination%22%3A%7B%7D%2C%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22west%22%3A-118.06753806201172%2C%22east%22%3A-117.75786093798828%2C%22south%22%3A34.00935556990931%2C%22north%22%3A34.08474003564825%7D%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A14542%2C%22regionType%22%3A6%7D%5D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A12%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=3',
            'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22pagination%22%3A%7B%22currentPage%22%3A2%7D%2C%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22west%22%3A-118.06753806201172%2C%22east%22%3A-117.75786093798828%2C%22south%22%3A34.00935556990931%2C%22north%22%3A34.08474003564825%7D%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A14542%2C%22regionType%22%3A6%7D%5D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A12%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=9']
cv_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.12060511608611%2C%22east%22%3A-117.72922193798829%2C%22south%22%3A34.04525256439482%2C%22west%22%3A-118.03889906201172%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A12%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A24245%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=12',
             'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.12060511608611%2C%22east%22%3A-117.72922193798829%2C%22south%22%3A34.04525256439482%2C%22west%22%3A-118.03889906201172%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A12%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A24245%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%22currentPage%22%3A2%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=13']
gl_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.239637942813424%2C%22east%22%3A-117.53512937597658%2C%22south%22%3A34.089077973784455%2C%22west%22%3A-118.15448362402346%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A11626%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=16',
            'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.239637942813424%2C%22east%22%3A-117.53512937597658%2C%22south%22%3A34.089077973784455%2C%22west%22%3A-118.15448362402346%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A11626%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%22currentPage%22%3A2%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=17']
az_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.247888645333454%2C%22east%22%3A-117.54786037597657%2C%22south%22%3A34.097343405645006%2C%22west%22%3A-118.16721462402344%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A37015%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=23']
sd_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.18729698642975%2C%22east%22%3A-117.50476187597656%2C%22south%22%3A34.03664365007653%2C%22west%22%3A-118.12411612402343%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A33836%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=26',
            'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.18729698642975%2C%22east%22%3A-117.50476187597656%2C%22south%22%3A34.03664365007653%2C%22west%22%3A-118.12411612402343%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A33836%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%22currentPage%22%3A2%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=27']
lv_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.22950338896044%2C%22east%22%3A-117.45802737597654%2C%22south%22%3A34.078925331781235%2C%22west%22%3A-118.07738162402342%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A39308%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=30',
            'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.22950338896044%2C%22east%22%3A-117.45802737597654%2C%22south%22%3A34.078925331781235%2C%22west%22%3A-118.07738162402342%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A11%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A39308%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%22currentPage%22%3A2%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=31']
cl_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.30829171413759%2C%22east%22%3A-117.08603725195314%2C%22south%22%3A34.00714860119482%2C%22west%22%3A-118.3247457480469%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A30908%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=34',
            'https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22usersSearchTerm%22%3A%22West%20Covina%2C%20CA%22%2C%22mapBounds%22%3A%7B%22north%22%3A34.30829171413759%2C%22east%22%3A-117.08603725195314%2C%22south%22%3A34.00714860119482%2C%22west%22%3A-118.3247457480469%7D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A30908%2C%22regionType%22%3A6%7D%5D%2C%22pagination%22%3A%7B%22currentPage%22%3A2%7D%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=35']
bp_pages = ['https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22pagination%22%3A%7B%7D%2C%22usersSearchTerm%22%3A%22Baldwin%20Park%2C%20CA%22%2C%22mapBounds%22%3A%7B%22west%22%3A-118.05260978100584%2C%22east%22%3A-117.89777121899412%2C%22south%22%3A34.06227583933882%2C%22north%22%3A34.09995292636617%7D%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A10241%2C%22regionType%22%3A6%7D%5D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%2C%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%7D%2C%22isListVisible%22%3Atrue%2C%22mapZoom%22%3A13%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22]}&requestId=3']

pages = wc_pages + cv_pages + gl_pages + az_pages + sd_pages + lv_pages + cl_pages + bp_pages

headers = {'Host': 'www.zillow.com',
           'User-Agent': '**user-agent**',
           'Accept': '*/*',
           'Accept-Language': 'en-US,en;q=0.5',
           'Accept-Encoding': 'gzip, deflate, br',
           'Cookie': '**cookie**',
           'Sec-Fetch-Dest': 'empty',
           'Sec-Fetch-Mode': 'cors',
           'Sec-Fetch-Site': 'same-origin'}

responses = [requests.get(page, headers=headers) for page in pages]
json_pages = [response.json()['cat1']['searchResults']['listResults'] for response in responses]

with open('home_json_pages.pkl', 'wb') as f:
    pickle.dump(json_pages, f)
